{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Run Python Task in Conda Env",
            "type": "shell",
            "command": "conda",
            "args": [
                "run",
                "-n",
                "dam_vp",
                "python",
                "task_adapting/main.py",
                "--base_dir",
                "~/dataset",
                "--pretrained_model",
                "vit-b-1k",
                "--adapt_method",
                "prompt_wo_head",
                "--test_dataset",
                "'oxford-flowers'",
                "--epochs",
                "50",
                "--lr",
                "0.5",
                "--weight_decay",
                "1e-4",
                "--checkpoint_dir",
                "checkpoints/vit-b-1k-wo-head.pth",
                "--num_gpus",
                "2"
            ],
            "options": {
                "env": {
                    "CUDA_VISIBLE_DEVICES": "0,1"
                }
            },
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            }
        },
        {
            "label": "Python One GPU",
            "type": "shell",
            "command": "conda",
            "args": [
                "run",
                "-n",
                "dam_vp",
                "python",
                "task_adapting/main.py",
                "--base_dir",
                "../dataset",
                "--pretrained_model",
                "vit-b-1k",
                "--adapt_method",
                "prompt_wo_head",
                "--test_dataset",
                "oxford-flowers",
                "--epochs",
                "50",
                "--lr",
                "0.5",
                "--weight_decay",
                "1e-4",
                "--checkpoint_dir",
                "checkpoints/vit-b-1k-wo-head.pth",
                "--dataset",
                "vtab-caltech101",
                "--num_gpus",
                "1"
            ],
            "options": {
                "env": {
                    "CUDA_VISIBLE_DEVICES": "0"
                }
            },
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "shared",
                "showReuseMessage": true,
                "clear": false
            }
        },
        {
            "label": "Run PyTorch Distributed cifar10",
            "type": "shell",
            "command": "conda",
            "args": [
                "run",
                "-n",
                "dam_vp",
                "python",
                "-m",
                "torch.distributed.launch",
                "--nproc_per_node=3",
                "--nnodes=1",
                "--node_rank=0",
                "--master_addr=localhost",
                "--master_port=1234",
                "task_adapting/main.py",
                "--output_dir",
                "result/cifar10",
                "--batch_size",
                "96",
                "--base_dir",
                "~/dataset",
                "--pretrained_model",
                "vit-b-1k",
                "--adapt_method",
                "prompt_wo_head",
                "--test_dataset",
                "cifar10",
                "--epochs",
                "50",
                "--lr",
                "0.5",
                "--weight_decay",
                "1e-4",
                "--checkpoint_dir",
                "checkpoints/vit-b-1k-wo-head.pth",
                "--dataset",
                "cifar10",
                "--num_gpus",
                "3",
                "--distributed"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "new"
            },
            "problemMatcher": [],
            "options": {
                "env": {
                    "CUDA_VISIBLE_DEVICES": "0,1,2",
                    "MASTER_ADDR": "localhost",
                    "MASTER_PORT": "1234",
                    "WORLD_SIZE": "3",
                    "RANK": "0",
                    "LOCAL_RANK": "0"
                }
            }
        },
        {
            "label": "Run PyTorch Distributed cifar10 22k",
            "type": "shell",
            "command": "conda",
            "args": [
                "run",
                "-n",
                "dam_vp",
                "python",
                "-m",
                "torch.distributed.launch",
                "--nproc_per_node=3",
                "--nnodes=1",
                "--node_rank=0",
                "--master_addr=localhost",
                "--master_port=1234",
                "task_adapting/main.py",
                "--output_dir",
                "result/cifar10_22k",
                "--batch_size",
                "96",
                "--base_dir",
                "~/dataset",
                "--pretrained_model",
                "vit-b-22k",
                "--adapt_method",
                "prompt_w_head",
                "--test_dataset",
                "cifar10",
                "--epochs",
                "50",
                "--lr",
                "0.5",
                "--weight_decay",
                "1e-4",
                "--checkpoint_dir",
                "checkpoints/vit-b-22k-w-head.pth",
                "--dataset",
                "cifar10",
                "--num_gpus",
                "3",
                "--distributed"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "new"
            },
            "problemMatcher": [],
            "options": {
                "env": {
                    "CUDA_VISIBLE_DEVICES": "0,1,2",
                    "MASTER_ADDR": "localhost",
                    "MASTER_PORT": "1234",
                    "WORLD_SIZE": "3",
                }
            }
        },
        {
            "label": "Run PyTorch Distributed cifar10 gaussian",
            "type": "shell",
            "command": "conda",
            "args": [
                "run",
                "-n",
                "dam_vp",
                "python",
                "-m",
                "torch.distributed.launch",
                "--nproc_per_node=3",
                "--nnodes=1",
                "--node_rank=0",
                "--master_addr=localhost",
                "--master_port=1234",
                "task_adapting/main.py",
                "--output_dir",
                "result/cifar10_gaussian",
                "--batch_size",
                "96",
                "--base_dir",
                "~/dataset",
                "--pretrained_model",
                "vit-b-22k",
                "--adapt_method",
                "prompt_w_head",
                "--test_dataset",
                "cifar10",
                "--epochs",
                "50",
                "--lr",
                "0.5",
                "--weight_decay",
                "1e-4",
                "--checkpoint_dir",
                "checkpoints/vit-b-22k-w-head.pth",
                "--dataset",
                "cifar10",
                "--num_gpus",
                "3",
                "--num_workers",
                "3",
                "--distributed"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "reveal": "always",
                "panel": "new"
            },
            "problemMatcher": [],
            "options": {
                "env": {
                    "PYTHONPATH": "~/miniconda3/envs/dam_vp/bin/python",
                    "CUDA_VISIBLE_DEVICES": "0,1,2",
                    "MASTER_ADDR": "localhost",
                    "MASTER_PORT": "1234",
                    "WORLD_SIZE": "3",
                    "NCLL_BLOCKING_WAIT": "1",
                    "NCCL_TIMEOUT": "200000",
                }
            }
        },
    ]
}